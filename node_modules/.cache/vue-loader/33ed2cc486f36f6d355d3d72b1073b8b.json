{"remainingRequest":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\views\\children\\changeData.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\views\\children\\changeData.vue","mtime":1638618512777},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636798923061},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\babel-loader\\lib\\index.js","mtime":1636798923794},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636798923061},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js","mtime":1636798923951}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IHttYXBTdGF0ZX0gZnJvbSAndnVleCcKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJfbmlja25hbWU6ICcnLAogICAgICB1c2VyX3NleDogJycsCiAgICAgIHVzZXJfcGhvbmU6ICcnLAogICAgICB1c2VyX2JpcnRoZGF5OiAnJywKICAgICAgdXNlcl9lbWFpbDogJycsCiAgICAgIHVzZXJfYXZhdGFyX2ltZ1VybDogJycsCiAgICAgIHVzZXJfYXZhdGFyOiBudWxsLAogICAgICBvcHRpb25zOiBbewogICAgICAgIHZhbHVlOiAn55S3JywKICAgICAgICBsYWJlbDogJ+eUtycKICAgICAgfSwgewogICAgICAgIHZhbHVlOiAn5aWzJywKICAgICAgICBsYWJlbDogJ+WlsycKICAgICAgfV0KICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgdGhpcy51c2VyX25pY2tuYW1lID0gSlNPTi5wYXJzZSh0aGlzLnVzZXIudXNlcikubmlja19uYW1lIHx8ICcnCiAgICB0aGlzLnVzZXJfc2V4ID0gSlNPTi5wYXJzZSh0aGlzLnVzZXIudXNlcikuc2V4IHx8ICcnCiAgICB0aGlzLnVzZXJfcGhvbmUgPSBKU09OLnBhcnNlKHRoaXMudXNlci51c2VyKS50ZWxlcGhvbmUgfHwgJycKICAgIHRoaXMudXNlcl9iaXJ0aGRheSA9IEpTT04ucGFyc2UodGhpcy51c2VyLnVzZXIpLmJpcnRoZGF5IHx8ICcnCiAgICB0aGlzLnVzZXJfZW1haWwgPSBKU09OLnBhcnNlKHRoaXMudXNlci51c2VyKS5lbWFpbCB8fCAnJwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKFsndXNlciddKQogIH0sCiAgbWV0aG9kczogewogICAgYmVmb3JlQXZhdGFyVXBsb2FkIChmaWxlKSB7CiAgICAgIGNvbnN0IGlzSlBHID0gZmlsZS50eXBlID09PSAnaW1hZ2UvanBlZycgfHwgZmlsZS50eXBlID09PSAnaW1hZ2UvcG5nJwogICAgICBjb25zdCBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDEKICAgICAgaWYgKCFpc0pQRykgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOWktOWDj+WbvueJh+WPquiDveaYryBKUEcg5oiWIFBORyDmoLzlvI8hJykKICAgICAgfQogICAgICBpZiAoIWlzTHQyTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOWktOWDj+WbvueJh+Wkp+Wwj+S4jeiDvei2hei/hyAxTUIhJykKICAgICAgfQogICAgICByZXR1cm4gaXNKUEcgJiYgaXNMdDJNCiAgICB9LAogICAgaGFuZGxlQXZhdGFyQ2hhbmdlIChmaWxlKSB7CiAgICAgIHRoaXMudXNlcl9hdmF0YXJfaW1nVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlLnJhdykKICAgICAgdGhpcy51c2VyX2F2YXRhciA9IGZpbGUucmF3CiAgICB9LAogICAgLy8g5L+u5pS555So5oi35L+h5oGvCiAgICBhc3luYyBzYXZlVXNlckluZm8gKCkgewogICAgICAvLyAzLjEg6K+35rGC5o6l5Y+jCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcl9uaWNrbmFtZScsIHRoaXMudXNlcl9uaWNrbmFtZSkKICAgICAgZm9ybURhdGEuYXBwZW5kKCd1c2VyX3NleCcsIHRoaXMudXNlcl9zZXgpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcl9hZGRyZXNzJywgdGhpcy5lbWFjcikKICAgICAgZm9ybURhdGEuYXBwZW5kKCd1c2VyX2JpcnRoZGF5JywgdGhpcy51c2VyX2JpcnRoZGF5KQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VzZXJfc2lnbicsIHRoaXMucGhvbmUpCiAgICAgIGlmICh0aGlzLnVzZXJfYXZhdGFyKSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd1c2VyX2F2YXRhcicsIHRoaXMudXNlcl9hdmF0YXIpCiAgICAgIH0KICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IGF4aW9zLnBvc3QoJy9pbWcnLCB7CiAgICAgICAgZm9ybURhdGEKICAgICAgfSkKICAgICAgLy8gMy4zIOi/lOWbnuS4u+eVjOmdogogICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgLy8gMy4yIOaPkOekuueUqOaItwogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogcmVzdWx0LmRhdGEKICAgICAgICB9KQogICAgICAgIC8vIDMuNCDmm7TmlrDmnKzlnLDmlbDmja4KICAgICAgICAvLyAzLjUg6L+U5Zue5Li755WM6Z2iCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnL2NlbnRlci9pbmZvcm1hdGlvbicpCiAgICAgICAgfSwgMjAwMCkKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["changeData.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"changeData.vue","sourceRoot":"src/views/children","sourcesContent":["<template>\n  <div class=\"user-detail\">\n    <div class=\"user-detail-top\">基本信息</div>\n    <div class=\"user-detail-group\">\n      <div class=\"user-icon\">\n        <span>头像</span>\n        <el-upload\n          class=\"avatar-uploader\"\n          action=\"\"\n          :auto-upload=\"false\"\n          :show-file-list=\"false\"\n          :before-upload=\"beforeAvatarUpload\"\n          :on-change=\"handleAvatarChange\"\n        >\n          <i class=\"el-icon-plus avatar-uploader-icon\"></i>\n        </el-upload>\n      </div>\n      <div class=\"user-item\">\n        <span>手机</span>\n        <span>{{ user.user.user_phone || \"暂未设置\" }}</span>\n      </div>\n      <div class=\"user-item\">\n        <span>邮箱</span>\n        <span>{{ user.user.email || \"暂未设置\" }}</span>\n      </div>\n      <div class=\"user-item\">\n        <span>昵称</span>\n        <el-input\n          type=\"text\"\n          placeholder=\"请输入内容\"\n          v-model=\"user_nickname\"\n          maxlength=\"15\"\n          show-word-limit\n          clearable\n          style=\"width:200px\"\n        >\n        </el-input>\n      </div>\n      <div class=\"user-item\">\n        <span>性别</span>\n        <el-select v-model=\"user_sex\" placeholder=\"请选择\">\n          <el-option\n            v-for=\"item in options\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\">\n          </el-option>\n        </el-select>\n      </div>\n      <div class=\"user-item\">\n        <span>生日</span>\n        <el-date-picker\n          v-model=\"user_birthday\"\n          type=\"date\"\n          placeholder=\"选择日期\"\n          value-format=\"yyyy-MM-dd\">\n        </el-date-picker>\n      </div>\n      <el-button type=\"danger\" @click=\"saveUserInfo()\">修改</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport {mapState} from 'vuex'\n\nexport default {\n  data () {\n    return {\n      user_nickname: '',\n      user_sex: '',\n      user_phone: '',\n      user_birthday: '',\n      user_email: '',\n      user_avatar_imgUrl: '',\n      user_avatar: null,\n      options: [{\n        value: '男',\n        label: '男'\n      }, {\n        value: '女',\n        label: '女'\n      }]\n    }\n  },\n  mounted () {\n    this.user_nickname = JSON.parse(this.user.user).nick_name || ''\n    this.user_sex = JSON.parse(this.user.user).sex || ''\n    this.user_phone = JSON.parse(this.user.user).telephone || ''\n    this.user_birthday = JSON.parse(this.user.user).birthday || ''\n    this.user_email = JSON.parse(this.user.user).email || ''\n  },\n  computed: {\n    ...mapState(['user'])\n  },\n  methods: {\n    beforeAvatarUpload (file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png'\n      const isLt2M = file.size / 1024 / 1024 < 1\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 或 PNG 格式!')\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 1MB!')\n      }\n      return isJPG && isLt2M\n    },\n    handleAvatarChange (file) {\n      this.user_avatar_imgUrl = URL.createObjectURL(file.raw)\n      this.user_avatar = file.raw\n    },\n    // 修改用户信息\n    async saveUserInfo () {\n      // 3.1 请求接口\n      let formData = new FormData()\n      formData.append('user_nickname', this.user_nickname)\n      formData.append('user_sex', this.user_sex)\n      formData.append('user_address', this.emacr)\n      formData.append('user_birthday', this.user_birthday)\n      formData.append('user_sign', this.phone)\n      if (this.user_avatar) {\n        formData.append('user_avatar', this.user_avatar)\n      }\n      let result = await axios.post('/img', {\n        formData\n      })\n      // 3.3 返回主界面\n      if (result.status === 200) {\n        // 3.2 提示用户\n        this.$message({\n          type: 'success',\n          message: result.data\n        })\n        // 3.4 更新本地数据\n        // 3.5 返回主界面\n        setTimeout(() => {\n          this.$router.replace('/center/information')\n        }, 2000)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-detail{\n  width: 70%;\n  height: 100%;\n  margin: 20px auto;\n}\n.user-detail-top{\n  width: 100%;\n  height: 60px;\n  line-height: 60px;\n  padding-left: 10px;\n  font-weight: bold;\n}\n.user-detail-group .user-icon{\n  height: 60px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #e0e0e0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.user-detail-group .user-item{\n  height: 50px;\n  padding: 0 10px;\n  background-color: #fff;\n  border-bottom: 1px solid #e0e0e0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.user-detail-group input{\n  border: 1px solid #ccc;\n  outline: none;\n  text-align: right;\n  width: 200px;\n}\n.user-detail-group button{\n  margin: 60px 0;\n  width: 15%;\n  font-size: 16px;\n  border-radius: 10px;\n  border: none;\n  outline: none;\n}\n.right-title-color{\n  color: #999;\n  font-size: 14px;\n}\n.avatar-uploader{\n  position: relative;\n  width: 56px;\n  height: 56px;\n}\n.avatar-uploader /deep/ .el-upload.el-upload--text {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  cursor: pointer;\n  overflow: hidden;\n}\n.avatar-uploader-icon {\n  position: absolute;\n  left: 0;\n  top: 0;\n  font-size: 28px;\n  color: #8c939d;\n  width: 100%;;\n  height: 100%;\n  line-height: 56px;\n  text-align: center;\n  opacity: 0;\n}\n.avatar-uploader-icon:hover{\n  opacity: 1;\n}\n.avatar {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n</style>\n"]}]}
{"remainingRequest":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\components\\ChatList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\components\\ChatList.vue","mtime":1640762493462},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636798923061},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\babel-loader\\lib\\index.js","mtime":1636798923794},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636798923061},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js","mtime":1636798923951}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgdXRpbCBmcm9tICcuLi91dGlscy91dGlsLmpzJw0KaW1wb3J0IHsgVG9hc3QgfSBmcm9tICdtaW50LXVpJzsNCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7DQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ2NoYXRsaXN0JywNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgd2Vic29jazogbnVsbCwNCiAgICAgICAgICAgIHNob3dTZWxCb3g6IDAsIC8vIDDpmpDol48gMeaYvuekuuihqOaDhSAy5pi+56S65YW25LuWDQogICAgICAgICAgICBzZWxGYWNlOiAn6KGo5oOFJywNCiAgICAgICAgICAgIHNlbE90aGVyOiAn5YW25LuW5Yqf6IO9JywNCiAgICAgICAgICAgIGNvbnRlbnQ6JycsDQogICAgICAgICAgICB0b3BTdGF0dXM6ICcnLA0KICAgICAgICAgICAgLy/kuKrkurrkv6Hmga8NCiAgICAgICAgICAgIG1pbmVJbWc6IG51bGwsDQogICAgICAgICAgICBtaW5lTmFtZTonJywNCiAgICAgICAgICAgIG1pbmVJRDonJywNCiAgICAgICAgICAgIG1pbmVUb2tlbjonJywNCiAgICAgICAgICAgIC8v5a+55pa55L+h5oGvDQogICAgICAgICAgICBvdGhlckltZ05hbWU6JycsDQogICAgICAgICAgICBvdGhlckltZzogbnVsbCwNCiAgICAgICAgICAgIG90aGVyTmFtZTonJywNCiAgICAgICAgICAgIG90aGVySUQ6JycsDQogICAgICAgICAgICAvL+iBiuWkqeiusOW9lQ0KICAgICAgICAgICAgcmVjb3JkczogW3sNCiAgICAgICAgICAgICAgICBpZDoxLA0KICAgICAgICAgICAgICAgIHR5cGU6IDEsDQogICAgICAgICAgICAgICAgdGltZTogdXRpbC5mb3JtYXREYXRlLmZvcm1hdChuZXcgRGF0ZSgpLCd5eXl5LU1NLWRkIGhoOm1tOnNzJyksDQogICAgICAgICAgICAgICAgY29udGVudDogJ+S9oOWlve+8gScNCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBpZDogMiwNCiAgICAgICAgICAgICAgICB0eXBlOiAyLA0KICAgICAgICAgICAgICAgIHRpbWU6IHV0aWwuZm9ybWF0RGF0ZS5mb3JtYXQobmV3IERhdGUoKSwneXl5eS1NTS1kZCBoaDptbTpzcycpLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICfkvaDlpb3vvIEnDQogICAgICAgICAgICB9XSwNCiAgICAgICAgfQ0KICAgIH0sDQogICAgY3JlYXRlZCgpIHsNCiAgICAgICAgY29uc3QgdGhhdCA9dGhpczsNCiAgICAgICAgdGhpcy5taW5lSW1nPXRoYXQuJHN0b3JlLnN0YXRlLnVzZXIuaW1nOw0KICAgICAgICB0aGlzLm1pbmVOYW1lPUpTT04ucGFyc2UodGhhdC4kc3RvcmUuc3RhdGUudXNlci51c2VyKS5uaWNrX25hbWU7DQogICAgICAgIHRoaXMubWluZUlEPUpTT04ucGFyc2UodGhhdC4kc3RvcmUuc3RhdGUudXNlci51c2VyKS5pZDsNCiAgICAgICAgdGhpcy5taW5lVG9rZW49dGhhdC4kc3RvcmUuc3RhdGUudXNlci50b2tlbjsNCiAgICAgICAgdGhpcy5vdGhlckltZ05hbWUgPSBKU09OLnBhcnNlKHRoaXMuJHN0b3JlLnN0YXRlLmltYWdlX3N0b3JlLnNlbGxlcl9pbmZvKS5hdmF0YXINCiAgICAgICAgdGhpcy5vdGhlck5hbWUgPSBKU09OLnBhcnNlKHRoaXMuJHN0b3JlLnN0YXRlLmltYWdlX3N0b3JlLnNlbGxlcl9pbmZvKS5wdWJsaXNoZXINCiAgICAgICAgdGhpcy5vdGhlcklEID0gSlNPTi5wYXJzZSh0aGlzLiRzdG9yZS5zdGF0ZS5pbWFnZV9zdG9yZS5zZWxsZXJfaW5mbykucHVibGlzaGVyaWQNCiAgICAgIA0KICAgICAgICBjb25zb2xlLmxvZygnbWluZUlkIGlzICcrdGhpcy5taW5lSUQpOw0KICAgICAgICBjb25zb2xlLmxvZygnbWluZU5hbWUgaXMgJyt0aGlzLm1pbmVOYW1lKTsNCiAgICAgICAgY29uc29sZS5sb2coJ290aGVySWQgaXMgJyt0aGlzLm90aGVySUQpOw0KICAgICAgICBjb25zb2xlLmxvZygnb3RoZXJJbWdOYW1lIGlzICcrdGhpcy5vdGhlckltZ05hbWUpDQogICAgICAgIHRoaXMuaW5pdFdlYlNvY2tldCgpOw0KICAgIH0sDQogICAgZGVzdHJveWVkKCkgew0KICAgICAgdGhpcy53ZWJzb2NrLmNsb3NlKCkgDQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIGdldEVYUDogZnVuY3Rpb24gKHBhZ2VOb3cscGFnZVNpemUpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLkVYUFMuc2xpY2UoKHBhZ2VOb3cgLSAxKSAqIHBhZ2VTaXplLCBwYWdlU2l6ZSAqIHBhZ2VOb3cpDQogICAgICAgIH0sDQogICAgICAgIC8v5Y+R6YCB5raI5oGvDQogICAgICAgIHNlbmRNc2c6IGZ1bmN0aW9uKCl7DQoNCiAgICAgICAgICAgIGlmKHRoaXMuY29udGVudD09Jycpew0KICAgICAgICAgICAgICAgIFRvYXN0KCfor7fovpPlhaXmtojmga8nKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBzZW5kPXRoaXMubWluZUlEKycsJyt0aGlzLm90aGVySUQrJywnK3RoaXMuY29udGVudA0KICAgICAgICAgICAgdGhpcy53ZWJzb2NrZXRzZW5kKHNlbmQpOw0KDQogICAgICAgICAgICB0aGlzLnJlY29yZHMucHVzaCh7DQogICAgICAgICAgICAgICAgdHlwZTogMSwNCiAgICAgICAgICAgICAgICB0aW1lOiB1dGlsLmZvcm1hdERhdGUuZm9ybWF0KG5ldyBEYXRlKCksJ3l5eXktTU0tZGQgaGg6bW06c3MnKSwNCiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm1pbmVOYW1lLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuY29udGVudA0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRoaXMuY29udGVudD0nJzsNCiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTsNCiAgIA0KICAgICAgICB9LA0KICAgICAgDQogICAgICAgIGZvY3VzVHh0Q29udGVudDpmdW5jdGlvbigpew0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3R4dENvbnRlbnQgaW5wdXQiKS5mb2N1cygpOw0KICAgICAgICB9LA0KICAgIA0KICAgICAgICBzY3JvbGxUb0JvdHRvbTpmdW5jdGlvbigpew0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIHZhciBjaGF0bGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NoYXRsaXN0JylbMF07DQogICAgICAgICAgICAgICAgY2hhdGxpc3Quc2Nyb2xsVG9wPWNoYXRsaXN0LnNjcm9sbEhlaWdodDsNCiAgICAgICAgICAgIH0sMTAwKTsNCiAgICAgICAgfSwNCiAgICAgIA0KICAgICAgICBoYW5kbGVUb3BDaGFuZ2Uoc3RhdHVzKSB7DQogICAgICAgICAgICB0aGlzLnRvcFN0YXR1cyA9IHN0YXR1czsNCiAgICAgICAgfSwNCiAgICAgICAgbG9hZFRvcChpZCkgew0KICAgICAgICAgICAgdmFyIF90aGlzPXRoaXM7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICB2YXIgY2hhdGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjaGF0bGlzdCcpWzBdOw0KICAgICAgICAgICAgICAgIHZhciBvbGRIZWlnaHQ9Y2hhdGxpc3Quc2Nyb2xsSGVpZ2h0Ow0KDQogICAgICAgICAgICAgICAgX3RoaXMucmVjb3Jkcy51bnNoaWZ0KHsNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogMSwNCiAgICAgICAgICAgICAgICAgICAgdGltZTogdXRpbC5mb3JtYXREYXRlLmZvcm1hdChuZXcgRGF0ZSgpLCd5eXl5LU1NLWRkIGhoOm1tOnNzJyksDQogICAgICAgICAgICAgICAgICAgIG5hbWU6ICfkvaAnLA0KICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn5L2g5aW977yBJw0KICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogMiwNCiAgICAgICAgICAgICAgICAgICAgdGltZTogdXRpbC5mb3JtYXREYXRlLmZvcm1hdChuZXcgRGF0ZSgpLCd5eXl5LU1NLWRkIGhoOm1tOnNzJyksDQogICAgICAgICAgICAgICAgICAgIG5hbWU6ICflr7nmlrknLA0KICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn5L2g5aW977yBJw0KICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SGVpZ2h0PWNoYXRsaXN0LnNjcm9sbEhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgY2hhdGxpc3Quc2Nyb2xsVG9wPW5ld0hlaWdodC1vbGRIZWlnaHQ7DQogICAgICAgICAgICAgICAgfSwxMDApOw0KDQogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5sb2FkbW9yZS5vblRvcExvYWRlZChpZCk7DQogICAgICAgICAgICB9LCAxNTAwKTsNCiAgICAgICAgfSwNCiAgICAgIGluaXRXZWJTb2NrZXQoKXsgLy/liJ3lp4vljJZ3ZW9zb2NrZXQNCiAgICAgICAgLy8gY29uc3Qgd3N1cmkgPSAid3M6Ly9kYXRhYmFzZS5zdXN0ZWNoc3RvcmUuY29tOjg4ODgvd2Vic29ja2V0IjsNCiAgICAgICAgY29uc3Qgd3N1cmkgPSAid3M6Ly9sb2NhbGhvc3Q6ODg4OC93ZWJzb2NrZXQiOw0KICAgICAgICB0aGlzLndlYnNvY2sgPSBuZXcgV2ViU29ja2V0KHdzdXJpKTsNCiAgICAgICAgdGhpcy53ZWJzb2NrLm9ubWVzc2FnZSA9IHRoaXMud2Vic29ja2V0b25tZXNzYWdlOw0KICAgICAgICB0aGlzLndlYnNvY2sub25vcGVuID0gdGhpcy53ZWJzb2NrZXRvbm9wZW47DQogICAgICAgIHRoaXMud2Vic29jay5vbmVycm9yID0gdGhpcy53ZWJzb2NrZXRvbmVycm9yOw0KICAgICAgICB0aGlzLndlYnNvY2sub25jbG9zZSA9IHRoaXMud2Vic29ja2V0Y2xvc2U7DQogICAgICB9LA0KICAgICAgd2Vic29ja2V0b25vcGVuKCl7IC8v6L+e5o6l5bu656uL5LmL5ZCO5omn6KGMc2VuZOaWueazleWPkemAgeaVsOaNrg0KICAgICAgICBsZXQgYWN0aW9ucyA9IHRoaXMubWluZUlEOw0KICAgICAgICAvLyB0aGlzLndlYnNvY2tldHNlbmQoSlNPTi5zdHJpbmdpZnkoYWN0aW9ucykpOw0KICAgICAgICB0aGlzLndlYnNvY2tldHNlbmQoYWN0aW9ucyk7DQogICAgICB9LA0KICAgICAgd2Vic29ja2V0b25lcnJvcigpey8v6L+e5o6l5bu656uL5aSx6LSl6YeN6L+eDQogICAgICAgIHRoaXMuaW5pdFdlYlNvY2tldCgpOw0KICAgICAgfSwNCiAgICAgIHdlYnNvY2tldG9ubWVzc2FnZShlKXsgLy/mlbDmja7mjqXmlLYNCiAgICAgICAgY29uc29sZS5sb2coZS5kYXRhKQ0KICAgICAgICB0aGlzLnJlY29yZHMucHVzaCh7DQogICAgICAgICAgICB0eXBlOiAyLA0KICAgICAgICAgICAgdGltZTogdXRpbC5mb3JtYXREYXRlLmZvcm1hdChuZXcgRGF0ZSgpLCd5eXl5LU1NLWRkIGhoOm1tOnNzJyksDQogICAgICAgICAgICBuYW1lOiB0aGlzLm90aGVyTmFtZSwNCiAgICAgICAgICAgIGNvbnRlbnQ6IGUuZGF0YQ0KICAgICAgICB9KTsNCiAgICAgICAgLy8gY29uc3QgcmVkYXRhID0gSlNPTi5wYXJzZShlLmRhdGEpOw0KICAgICAgICAvLyBjb25zb2xlLmxvZygncmVjZWl2ZScrcmVkYXRhKQ0KICAgICAgfSwNCiAgICAgIHdlYnNvY2tldHNlbmQoRGF0YSl7Ly/mlbDmja7lj5HpgIENCiAgICAgICAgdGhpcy53ZWJzb2NrLnNlbmQoRGF0YSk7DQogICAgICAgIGNvbnNvbGUubG9nKCdzZW5kJytEYXRhKQ0KICAgICAgfSwNCiAgICAgIHdlYnNvY2tldGNsb3NlKGUpeyAgLy/lhbPpl60NCiAgICAgICAgY29uc29sZS5sb2coJ+aWreW8gOi/nuaOpScsZSk7DQogICAgICB9LA0KICAgIH0sDQogICAgYXN5bmMgbW91bnRlZCgpIHsNCiAgICAgICAgY29uc3QgdGhhdD10aGlzOw0KICAgICAgICB0aGlzLnNjcm9sbFRvQm90dG9tKCk7DQoNCiAgICAgICAgbGV0IGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCkNCiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCdtaW5lSWQnLCB0aGlzLm1pbmVJRCkNCiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCdvdGhlcklkJywgdGhpcy5vdGhlcklEKQ0KDQogICAgICAgIGF3YWl0IGF4aW9zKHsNCiAgICAgICAgdXJsOiIvcm9vdCIrIi9jaGF0aGlzdG9yeSIsDQogICAgICAgIG1ldGhvZDoncG9zdCcsDQogICAgICAgIGRhdGE6Zm9ybWRhdGENCiAgICAgICAgfSkudGhlbihyZXMgPT4gKHRoaXMucmVjb3JkcyA9IHJlcy5kYXRhKSkNCg0KICAgICAgICBjb25zb2xlLmxvZygnQ2hhdCBoaXN0b3J5IGlzJyt0aGlzLnJlY29yZHMpDQogICAgICAgIA0KICAgICAgICBhd2FpdCB0aGlzLiRheGlvcy5nZXQoJy9yb290JyArICcvaXRlbXMvcGljdHVyZS8nICsgdGhhdC5vdGhlckltZ05hbWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgew0KICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7DQogICAgICAgICAgICB0aGF0Lm90aGVySW1nID0gcmVzLmRhdGF9DQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikNCiAgICAgICAgfSkNCg0KICAgIH0NCn0NCg=="},{"version":3,"sources":["ChatList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"ChatList.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <section class=\"chatlist\" :class=\"showSelBox>0?'chatlist-bottom-collapse':'chatlist-bottom'\">\r\n            <ul>\r\n                <div v-for=\"item in records\" :key=\"item.id\">\r\n                    <li class=\"chat-mine\" v-if=\"item.type==1\" style=\"list-style-type:none;\">\r\n                        <div class=\"chat-user\"><img :src=\"mineImg\"></div>\r\n                        <div class=\"time\"><cite><i>{{item.time}}</i>{{mineName}}</cite></div>\r\n                        <div class=\"chat-text\" v-html=\"item.content\"></div>\r\n                    </li>\r\n                    <li class=\"chat-other\" v-if=\"item.type==2\" style=\"list-style-type:none;\">\r\n                        <div class=\"chat-user\"><img :src=\"otherImg\"></div>\r\n                        <div class=\"time\"><cite>{{otherName}}<i>{{item.time}}</i></cite></div>\r\n                        <div class=\"chat-text\" v-html=\"item.content\"></div>\r\n                    </li>\r\n                </div>\r\n            </ul>\r\n        </section>\r\n\r\n        <section class=\"foot\">\r\n            <!-- <mt-field id=\"txtContent\" placeholder=\"请输入消息\" class=\"con\" v-model=\"content\"></mt-field> -->\r\n            <el-col :span=\"23\" >\r\n                <el-input class=\"txtContent\" v-model=\"content\" placeholder=\"请输入消息\" ></el-input>\r\n            </el-col>\r\n            <el-col :span=\"1\" :offset=\"8\">\r\n                <span class=\"btn btn-send\" v-on:click=\"sendMsg\">发送</span>\r\n            </el-col>\r\n            \r\n            <!-- <span class=\"btn-face\" v-on:click=\"showSelBox=showSelBox==1?0:1\"><i class=\"fa fa-smile-o\" aria-hidden=\"true\"></i></span> -->        \r\n            <!-- <section class=\"selbox\" :class=\"showSelBox>0?'show':'hide'\">\r\n                <section v-show=\"showSelBox==1\" class=\"face-box\">\r\n                    <mt-swipe :auto=\"0\" :continuous=\"false\">\r\n                        <mt-swipe-item v-for=\"n in Math.ceil(EXPS.length/18)\" :key=\"n\">\r\n                            <li v-for=\"(item, index) in getEXP(n,18)\" :key=\"index\">\r\n                                <img :src=\"'static/emotion/'+item.file\" alt=\"\" :data=\"item.code\" v-on:click=\"content+=item.code\">\r\n                            </li>\r\n                        </mt-swipe-item>\r\n                    </mt-swipe>\r\n                </section>\r\n                <div v-show=\"showSelBox==2\">{{selOther}}</div>\r\n            </section> -->\r\n        </section>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport util from '../utils/util.js'\r\nimport { Toast } from 'mint-ui';\r\nimport axios from 'axios';\r\nexport default {\r\n    name: 'chatlist',\r\n    data() {\r\n        return {\r\n            websock: null,\r\n            showSelBox: 0, // 0隐藏 1显示表情 2显示其他\r\n            selFace: '表情',\r\n            selOther: '其他功能',\r\n            content:'',\r\n            topStatus: '',\r\n            //个人信息\r\n            mineImg: null,\r\n            mineName:'',\r\n            mineID:'',\r\n            mineToken:'',\r\n            //对方信息\r\n            otherImgName:'',\r\n            otherImg: null,\r\n            otherName:'',\r\n            otherID:'',\r\n            //聊天记录\r\n            records: [{\r\n                id:1,\r\n                type: 1,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                content: '你好！'\r\n            }, {\r\n                id: 2,\r\n                type: 2,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                content: '你好！'\r\n            }],\r\n        }\r\n    },\r\n    created() {\r\n        const that =this;\r\n        this.mineImg=that.$store.state.user.img;\r\n        this.mineName=JSON.parse(that.$store.state.user.user).nick_name;\r\n        this.mineID=JSON.parse(that.$store.state.user.user).id;\r\n        this.mineToken=that.$store.state.user.token;\r\n        this.otherImgName = JSON.parse(this.$store.state.image_store.seller_info).avatar\r\n        this.otherName = JSON.parse(this.$store.state.image_store.seller_info).publisher\r\n        this.otherID = JSON.parse(this.$store.state.image_store.seller_info).publisherid\r\n      \r\n        console.log('mineId is '+this.mineID);\r\n        console.log('mineName is '+this.mineName);\r\n        console.log('otherId is '+this.otherID);\r\n        console.log('otherImgName is '+this.otherImgName)\r\n        this.initWebSocket();\r\n    },\r\n    destroyed() {\r\n      this.websock.close() \r\n    },\r\n    methods: {\r\n        getEXP: function (pageNow,pageSize) {\r\n            return this.EXPS.slice((pageNow - 1) * pageSize, pageSize * pageNow)\r\n        },\r\n        //发送消息\r\n        sendMsg: function(){\r\n\r\n            if(this.content==''){\r\n                Toast('请输入消息');\r\n                return;\r\n            }\r\n\r\n            var send=this.mineID+','+this.otherID+','+this.content\r\n            this.websocketsend(send);\r\n\r\n            this.records.push({\r\n                type: 1,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                name: this.mineName,\r\n                content: this.content\r\n            });\r\n\r\n            this.content='';\r\n            this.scrollToBottom();\r\n   \r\n        },\r\n      \r\n        focusTxtContent:function(){\r\n            document.querySelector(\"#txtContent input\").focus();\r\n        },\r\n    \r\n        scrollToBottom:function(){\r\n            setTimeout(function(){\r\n                var chatlist = document.getElementsByClassName('chatlist')[0];\r\n                chatlist.scrollTop=chatlist.scrollHeight;\r\n            },100);\r\n        },\r\n      \r\n        handleTopChange(status) {\r\n            this.topStatus = status;\r\n        },\r\n        loadTop(id) {\r\n            var _this=this;\r\n            setTimeout(() => {\r\n                var chatlist = document.getElementsByClassName('chatlist')[0];\r\n                var oldHeight=chatlist.scrollHeight;\r\n\r\n                _this.records.unshift({\r\n                    type: 1,\r\n                    time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                    name: '你',\r\n                    content: '你好！'\r\n                }, {\r\n                    type: 2,\r\n                    time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                    name: '对方',\r\n                    content: '你好！'\r\n                });\r\n\r\n                setTimeout(function(){\r\n                    var newHeight=chatlist.scrollHeight;\r\n                    chatlist.scrollTop=newHeight-oldHeight;\r\n                },100);\r\n\r\n                this.$refs.loadmore.onTopLoaded(id);\r\n            }, 1500);\r\n        },\r\n      initWebSocket(){ //初始化weosocket\r\n        // const wsuri = \"ws://database.sustechstore.com:8888/websocket\";\r\n        const wsuri = \"ws://localhost:8888/websocket\";\r\n        this.websock = new WebSocket(wsuri);\r\n        this.websock.onmessage = this.websocketonmessage;\r\n        this.websock.onopen = this.websocketonopen;\r\n        this.websock.onerror = this.websocketonerror;\r\n        this.websock.onclose = this.websocketclose;\r\n      },\r\n      websocketonopen(){ //连接建立之后执行send方法发送数据\r\n        let actions = this.mineID;\r\n        // this.websocketsend(JSON.stringify(actions));\r\n        this.websocketsend(actions);\r\n      },\r\n      websocketonerror(){//连接建立失败重连\r\n        this.initWebSocket();\r\n      },\r\n      websocketonmessage(e){ //数据接收\r\n        console.log(e.data)\r\n        this.records.push({\r\n            type: 2,\r\n            time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n            name: this.otherName,\r\n            content: e.data\r\n        });\r\n        // const redata = JSON.parse(e.data);\r\n        // console.log('receive'+redata)\r\n      },\r\n      websocketsend(Data){//数据发送\r\n        this.websock.send(Data);\r\n        console.log('send'+Data)\r\n      },\r\n      websocketclose(e){  //关闭\r\n        console.log('断开连接',e);\r\n      },\r\n    },\r\n    async mounted() {\r\n        const that=this;\r\n        this.scrollToBottom();\r\n\r\n        let formdata = new FormData()\r\n        formdata.append('mineId', this.mineID)\r\n        formdata.append('otherId', this.otherID)\r\n\r\n        await axios({\r\n        url:\"/root\"+\"/chathistory\",\r\n        method:'post',\r\n        data:formdata\r\n        }).then(res => (this.records = res.data))\r\n\r\n        console.log('Chat history is'+this.records)\r\n        \r\n        await this.$axios.get('/root' + '/items/picture/' + that.otherImgName).then(function (res) {\r\n        if (res.status === 200) {\r\n            that.otherImg = res.data}\r\n        }).catch(function (error) {\r\n        console.log(error)\r\n        })\r\n\r\n    }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style>\r\n    .chatlist {\r\n        position: absolute;\r\n        top: 60px;\r\n        bottom: 48px;\r\n        left: 0px;\r\n        right: 0px;\r\n        overflow-y: scroll;\r\n        overflow-x: hidden;\r\n        padding: 10px;\r\n    }\r\n    \r\n    .chatlist-bottom {\r\n        bottom: 48px;\r\n    }\r\n    \r\n    .chatlist-bottom-collapse {\r\n        bottom: 198px;\r\n    }\r\n    \r\n    .chatlist ul {\r\n        min-height: 300px;\r\n    }\r\n    \r\n    .chatlist ul .chat-mine {\r\n        text-align: right;\r\n        padding-left: 0;\r\n        padding-right: 60px;\r\n    }\r\n\r\n    .chatlist ul .chat-other {\r\n        text-align: left;\r\n        padding-left: 30px;\r\n        padding-right: 0;\r\n    }\r\n    \r\n    .chatlist ul li {\r\n        position: relative;\r\n        /* font-size: 0; */\r\n        margin-bottom: 10px;\r\n        padding-left: 60px;\r\n        min-height: 68px;\r\n    }\r\n    \r\n    .chat-mine .chat-user {\r\n        left: auto;\r\n        right: 3px;\r\n    }\r\n\r\n    .chat-other .chat-user {\r\n        right: auto;\r\n        left: -25px;\r\n    }\r\n    \r\n    .chat-user {\r\n        position: absolute;\r\n        /* left: 3px; */\r\n    }\r\n    \r\n    /* .chat-text, */\r\n    .chat-user {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        /*font-size: 14px;*/\r\n    }\r\n    \r\n    .chat-user img {\r\n        width: 45px;\r\n        height: 45px;\r\n        border-radius: 100%;\r\n    }\r\n    \r\n    .time {\r\n        width: 100%;\r\n    }\r\n    \r\n    cite {\r\n        left: auto;\r\n        right: 60px;\r\n        text-align: right;\r\n    }\r\n    \r\n    cite {\r\n        font-style: normal;\r\n        line-height: 24px;\r\n        font-size: 20px;\r\n        white-space: nowrap;\r\n        color: #999;\r\n        text-align: left;\r\n    }\r\n    \r\n    cite i {\r\n        font-style: normal;\r\n        padding-left: 5px;\r\n        padding-right: 5px;\r\n        font-size: 12px;\r\n    }\r\n    \r\n    .chat-mine .chat-text {\r\n        margin-left: 0;\r\n        text-align: left;\r\n        background-color: #33DF83;\r\n        color: #fff;\r\n    }\r\n\r\n    .chat-other .chat-text {\r\n        margin-right: 0;\r\n        text-align: right;\r\n        background-color: #444647;\r\n        color: #fff;\r\n    }\r\n\r\n    .chat-text {\r\n        position: relative;\r\n        line-height: 22px;\r\n        margin-top: 10px;\r\n        padding: 10px 15px;\r\n        background-color: #eee;\r\n        border-radius: 3px;\r\n        color: #333;\r\n        word-break: break-all;\r\n        max-width: 462px\\9;\r\n    }\r\n    \r\n    .chat-text,\r\n    .chat-user {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        font-size: 14px;\r\n    }\r\n    \r\n    .chat-text img {\r\n        max-width: 100%;\r\n        vertical-align: middle;\r\n    }\r\n    \r\n    .chat-user {\r\n        position: absolute;\r\n        left: 3px;\r\n    }\r\n    \r\n    .chat-text:after {\r\n        content: '';\r\n        position: absolute;\r\n        left: -10px;\r\n        top: 15px;\r\n        width: 0;\r\n        height: 0;\r\n        border-style: solid dashed dashed;\r\n        border-color: #eee transparent transparent;\r\n        overflow: hidden;\r\n        border-width: 10px;\r\n    }\r\n    \r\n    .chat-mine .chat-text:after {\r\n        left: auto;\r\n        right: -10px;\r\n        border-top-color: #33DF83;\r\n    }\r\n    .chat-other .chat-text:after {\r\n        right: auto;\r\n        left: -10px;\r\n        border-top-color: #444647;\r\n    }\r\n    \r\n    .foot {\r\n        width: 100%;\r\n        min-height: 4px;\r\n        position: fixed;\r\n        bottom: 4px;\r\n        left: 0px;\r\n        background-color: #F8F8F8;\r\n    }\r\n    \r\n    .foot .con {\r\n        position: absolute;\r\n        left: 66px;\r\n        right: 40px;\r\n    }\r\n    \r\n    .foot .btn-plus {\r\n        width: 28px;\r\n        padding: 9px 3px;\r\n        position: absolute;\r\n        left: 0px;\r\n        border-left: 1px solid #d9d9d9;\r\n    }\r\n    \r\n    .foot .btn-plus i {\r\n        font-size: 2em;\r\n        color: #ccc;\r\n    }\r\n    \r\n    .foot .btn-face {\r\n        width: 28px;\r\n        padding: 9px 3px 9px 0px;\r\n        position: absolute;\r\n        left: 35px;\r\n        /*border-right: 1px solid #d9d9d9;*/\r\n    }\r\n    \r\n    .foot .btn-face i {\r\n        font-size: 2em;\r\n        color: #d9d9d9;\r\n    }\r\n    \r\n    .foot .selbox {\r\n        height: 150px;\r\n        margin-top: 48px;\r\n        border-top: 1px solid #d9d9d9;\r\n    }\r\n    \r\n    .show {\r\n        display: block;\r\n    }\r\n    \r\n    .hide {\r\n        display: none;\r\n    }\r\n    \r\n    .face-box {\r\n        position: absolute;\r\n        top: 48px;\r\n        left: 0px;\r\n        right: 0px;\r\n        bottom: 0px;\r\n        padding: 15px 15px 0px 15px;\r\n        overflow: hidden;\r\n        width: 290px;\r\n        margin: 0px auto;\r\n        height: 135px;\r\n    }\r\n    \r\n    .face-box li {\r\n        width: 30px;\r\n        float: left;\r\n        padding: 6px 10px 0px 8px;\r\n    }\r\n    \r\n    .btn {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        font-size: 14px;\r\n        line-height: 32px;\r\n        margin-left: 5px;\r\n        padding: 0 6px;\r\n        background-color: #33DF83;\r\n        color: #fff;\r\n        border-radius: 3px;\r\n    }\r\n    \r\n    .btn-send {\r\n        position: absolute;\r\n        right: 3px;\r\n        top: 6px;\r\n    }\r\n\r\n    /* .txtContent {\r\n       margin-right: 40px; \r\n    } */\r\n</style>"]}]}
{"remainingRequest":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\components\\ChatList.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\src\\components\\ChatList.vue","mtime":1640762493462},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\css-loader\\dist\\cjs.js","mtime":1636798923408},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1636798924294},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\postcss-loader\\src\\index.js","mtime":1636798923792},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636798923061},{"path":"D:\\学习历史资料\\大三上学期\\面向对象\\Project\\sustech-store\\node_modules\\vue-loader\\lib\\index.js","mtime":1636798923951}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jaGF0bGlzdCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDYwcHg7CiAgICBib3R0b206IDQ4cHg7CiAgICBsZWZ0OiAwcHg7CiAgICByaWdodDogMHB4OwogICAgb3ZlcmZsb3cteTogc2Nyb2xsOwogICAgb3ZlcmZsb3cteDogaGlkZGVuOwogICAgcGFkZGluZzogMTBweDsKfQoKLmNoYXRsaXN0LWJvdHRvbSB7CiAgICBib3R0b206IDQ4cHg7Cn0KCi5jaGF0bGlzdC1ib3R0b20tY29sbGFwc2UgewogICAgYm90dG9tOiAxOThweDsKfQoKLmNoYXRsaXN0IHVsIHsKICAgIG1pbi1oZWlnaHQ6IDMwMHB4Owp9CgouY2hhdGxpc3QgdWwgLmNoYXQtbWluZSB7CiAgICB0ZXh0LWFsaWduOiByaWdodDsKICAgIHBhZGRpbmctbGVmdDogMDsKICAgIHBhZGRpbmctcmlnaHQ6IDYwcHg7Cn0KCi5jaGF0bGlzdCB1bCAuY2hhdC1vdGhlciB7CiAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgcGFkZGluZy1sZWZ0OiAzMHB4OwogICAgcGFkZGluZy1yaWdodDogMDsKfQoKLmNoYXRsaXN0IHVsIGxpIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIC8qIGZvbnQtc2l6ZTogMDsgKi8KICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICBwYWRkaW5nLWxlZnQ6IDYwcHg7CiAgICBtaW4taGVpZ2h0OiA2OHB4Owp9CgouY2hhdC1taW5lIC5jaGF0LXVzZXIgewogICAgbGVmdDogYXV0bzsKICAgIHJpZ2h0OiAzcHg7Cn0KCi5jaGF0LW90aGVyIC5jaGF0LXVzZXIgewogICAgcmlnaHQ6IGF1dG87CiAgICBsZWZ0OiAtMjVweDsKfQoKLmNoYXQtdXNlciB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAvKiBsZWZ0OiAzcHg7ICovCn0KCi8qIC5jaGF0LXRleHQsICovCi5jaGF0LXVzZXIgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgdmVydGljYWwtYWxpZ246IHRvcDsKICAgIC8qZm9udC1zaXplOiAxNHB4OyovCn0KCi5jaGF0LXVzZXIgaW1nIHsKICAgIHdpZHRoOiA0NXB4OwogICAgaGVpZ2h0OiA0NXB4OwogICAgYm9yZGVyLXJhZGl1czogMTAwJTsKfQoKLnRpbWUgewogICAgd2lkdGg6IDEwMCU7Cn0KCmNpdGUgewogICAgbGVmdDogYXV0bzsKICAgIHJpZ2h0OiA2MHB4OwogICAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0KCmNpdGUgewogICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgbGluZS1oZWlnaHQ6IDI0cHg7CiAgICBmb250LXNpemU6IDIwcHg7CiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgY29sb3I6ICM5OTk7CiAgICB0ZXh0LWFsaWduOiBsZWZ0Owp9CgpjaXRlIGkgewogICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgcGFkZGluZy1sZWZ0OiA1cHg7CiAgICBwYWRkaW5nLXJpZ2h0OiA1cHg7CiAgICBmb250LXNpemU6IDEycHg7Cn0KCi5jaGF0LW1pbmUgLmNoYXQtdGV4dCB7CiAgICBtYXJnaW4tbGVmdDogMDsKICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzNERjgzOwogICAgY29sb3I6ICNmZmY7Cn0KCi5jaGF0LW90aGVyIC5jaGF0LXRleHQgewogICAgbWFyZ2luLXJpZ2h0OiAwOwogICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDQ0NjQ3OwogICAgY29sb3I6ICNmZmY7Cn0KCi5jaGF0LXRleHQgewogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgbGluZS1oZWlnaHQ6IDIycHg7CiAgICBtYXJnaW4tdG9wOiAxMHB4OwogICAgcGFkZGluZzogMTBweCAxNXB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTsKICAgIGJvcmRlci1yYWRpdXM6IDNweDsKICAgIGNvbG9yOiAjMzMzOwogICAgd29yZC1icmVhazogYnJlYWstYWxsOwogICAgbWF4LXdpZHRoOiA0NjJweFw5Owp9CgouY2hhdC10ZXh0LAouY2hhdC11c2VyIHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgICBmb250LXNpemU6IDE0cHg7Cn0KCi5jaGF0LXRleHQgaW1nIHsKICAgIG1heC13aWR0aDogMTAwJTsKICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Cn0KCi5jaGF0LXVzZXIgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgbGVmdDogM3B4Owp9CgouY2hhdC10ZXh0OmFmdGVyIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgbGVmdDogLTEwcHg7CiAgICB0b3A6IDE1cHg7CiAgICB3aWR0aDogMDsKICAgIGhlaWdodDogMDsKICAgIGJvcmRlci1zdHlsZTogc29saWQgZGFzaGVkIGRhc2hlZDsKICAgIGJvcmRlci1jb2xvcjogI2VlZSB0cmFuc3BhcmVudCB0cmFuc3BhcmVudDsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBib3JkZXItd2lkdGg6IDEwcHg7Cn0KCi5jaGF0LW1pbmUgLmNoYXQtdGV4dDphZnRlciB7CiAgICBsZWZ0OiBhdXRvOwogICAgcmlnaHQ6IC0xMHB4OwogICAgYm9yZGVyLXRvcC1jb2xvcjogIzMzREY4MzsKfQouY2hhdC1vdGhlciAuY2hhdC10ZXh0OmFmdGVyIHsKICAgIHJpZ2h0OiBhdXRvOwogICAgbGVmdDogLTEwcHg7CiAgICBib3JkZXItdG9wLWNvbG9yOiAjNDQ0NjQ3Owp9CgouZm9vdCB7CiAgICB3aWR0aDogMTAwJTsKICAgIG1pbi1oZWlnaHQ6IDRweDsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGJvdHRvbTogNHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogI0Y4RjhGODsKfQoKLmZvb3QgLmNvbiB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBsZWZ0OiA2NnB4OwogICAgcmlnaHQ6IDQwcHg7Cn0KCi5mb290IC5idG4tcGx1cyB7CiAgICB3aWR0aDogMjhweDsKICAgIHBhZGRpbmc6IDlweCAzcHg7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBsZWZ0OiAwcHg7CiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNkOWQ5ZDk7Cn0KCi5mb290IC5idG4tcGx1cyBpIHsKICAgIGZvbnQtc2l6ZTogMmVtOwogICAgY29sb3I6ICNjY2M7Cn0KCi5mb290IC5idG4tZmFjZSB7CiAgICB3aWR0aDogMjhweDsKICAgIHBhZGRpbmc6IDlweCAzcHggOXB4IDBweDsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGxlZnQ6IDM1cHg7CiAgICAvKmJvcmRlci1yaWdodDogMXB4IHNvbGlkICNkOWQ5ZDk7Ki8KfQoKLmZvb3QgLmJ0bi1mYWNlIGkgewogICAgZm9udC1zaXplOiAyZW07CiAgICBjb2xvcjogI2Q5ZDlkOTsKfQoKLmZvb3QgLnNlbGJveCB7CiAgICBoZWlnaHQ6IDE1MHB4OwogICAgbWFyZ2luLXRvcDogNDhweDsKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZDlkOWQ5Owp9Cgouc2hvdyB7CiAgICBkaXNwbGF5OiBibG9jazsKfQoKLmhpZGUgewogICAgZGlzcGxheTogbm9uZTsKfQoKLmZhY2UtYm94IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogNDhweDsKICAgIGxlZnQ6IDBweDsKICAgIHJpZ2h0OiAwcHg7CiAgICBib3R0b206IDBweDsKICAgIHBhZGRpbmc6IDE1cHggMTVweCAwcHggMTVweDsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICB3aWR0aDogMjkwcHg7CiAgICBtYXJnaW46IDBweCBhdXRvOwogICAgaGVpZ2h0OiAxMzVweDsKfQoKLmZhY2UtYm94IGxpIHsKICAgIHdpZHRoOiAzMHB4OwogICAgZmxvYXQ6IGxlZnQ7CiAgICBwYWRkaW5nOiA2cHggMTBweCAwcHggOHB4Owp9CgouYnRuIHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgICBmb250LXNpemU6IDE0cHg7CiAgICBsaW5lLWhlaWdodDogMzJweDsKICAgIG1hcmdpbi1sZWZ0OiA1cHg7CiAgICBwYWRkaW5nOiAwIDZweDsKICAgIGJhY2tncm91bmQtY29sb3I6ICMzM0RGODM7CiAgICBjb2xvcjogI2ZmZjsKICAgIGJvcmRlci1yYWRpdXM6IDNweDsKfQoKLmJ0bi1zZW5kIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHJpZ2h0OiAzcHg7CiAgICB0b3A6IDZweDsKfQoKLyogLnR4dENvbnRlbnQgewogICBtYXJnaW4tcmlnaHQ6IDQwcHg7IAp9ICovCg=="},{"version":3,"sources":["ChatList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"ChatList.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <section class=\"chatlist\" :class=\"showSelBox>0?'chatlist-bottom-collapse':'chatlist-bottom'\">\r\n            <ul>\r\n                <div v-for=\"item in records\" :key=\"item.id\">\r\n                    <li class=\"chat-mine\" v-if=\"item.type==1\" style=\"list-style-type:none;\">\r\n                        <div class=\"chat-user\"><img :src=\"mineImg\"></div>\r\n                        <div class=\"time\"><cite><i>{{item.time}}</i>{{mineName}}</cite></div>\r\n                        <div class=\"chat-text\" v-html=\"item.content\"></div>\r\n                    </li>\r\n                    <li class=\"chat-other\" v-if=\"item.type==2\" style=\"list-style-type:none;\">\r\n                        <div class=\"chat-user\"><img :src=\"otherImg\"></div>\r\n                        <div class=\"time\"><cite>{{otherName}}<i>{{item.time}}</i></cite></div>\r\n                        <div class=\"chat-text\" v-html=\"item.content\"></div>\r\n                    </li>\r\n                </div>\r\n            </ul>\r\n        </section>\r\n\r\n        <section class=\"foot\">\r\n            <!-- <mt-field id=\"txtContent\" placeholder=\"请输入消息\" class=\"con\" v-model=\"content\"></mt-field> -->\r\n            <el-col :span=\"23\" >\r\n                <el-input class=\"txtContent\" v-model=\"content\" placeholder=\"请输入消息\" ></el-input>\r\n            </el-col>\r\n            <el-col :span=\"1\" :offset=\"8\">\r\n                <span class=\"btn btn-send\" v-on:click=\"sendMsg\">发送</span>\r\n            </el-col>\r\n            \r\n            <!-- <span class=\"btn-face\" v-on:click=\"showSelBox=showSelBox==1?0:1\"><i class=\"fa fa-smile-o\" aria-hidden=\"true\"></i></span> -->        \r\n            <!-- <section class=\"selbox\" :class=\"showSelBox>0?'show':'hide'\">\r\n                <section v-show=\"showSelBox==1\" class=\"face-box\">\r\n                    <mt-swipe :auto=\"0\" :continuous=\"false\">\r\n                        <mt-swipe-item v-for=\"n in Math.ceil(EXPS.length/18)\" :key=\"n\">\r\n                            <li v-for=\"(item, index) in getEXP(n,18)\" :key=\"index\">\r\n                                <img :src=\"'static/emotion/'+item.file\" alt=\"\" :data=\"item.code\" v-on:click=\"content+=item.code\">\r\n                            </li>\r\n                        </mt-swipe-item>\r\n                    </mt-swipe>\r\n                </section>\r\n                <div v-show=\"showSelBox==2\">{{selOther}}</div>\r\n            </section> -->\r\n        </section>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport util from '../utils/util.js'\r\nimport { Toast } from 'mint-ui';\r\nimport axios from 'axios';\r\nexport default {\r\n    name: 'chatlist',\r\n    data() {\r\n        return {\r\n            websock: null,\r\n            showSelBox: 0, // 0隐藏 1显示表情 2显示其他\r\n            selFace: '表情',\r\n            selOther: '其他功能',\r\n            content:'',\r\n            topStatus: '',\r\n            //个人信息\r\n            mineImg: null,\r\n            mineName:'',\r\n            mineID:'',\r\n            mineToken:'',\r\n            //对方信息\r\n            otherImgName:'',\r\n            otherImg: null,\r\n            otherName:'',\r\n            otherID:'',\r\n            //聊天记录\r\n            records: [{\r\n                id:1,\r\n                type: 1,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                content: '你好！'\r\n            }, {\r\n                id: 2,\r\n                type: 2,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                content: '你好！'\r\n            }],\r\n        }\r\n    },\r\n    created() {\r\n        const that =this;\r\n        this.mineImg=that.$store.state.user.img;\r\n        this.mineName=JSON.parse(that.$store.state.user.user).nick_name;\r\n        this.mineID=JSON.parse(that.$store.state.user.user).id;\r\n        this.mineToken=that.$store.state.user.token;\r\n        this.otherImgName = JSON.parse(this.$store.state.image_store.seller_info).avatar\r\n        this.otherName = JSON.parse(this.$store.state.image_store.seller_info).publisher\r\n        this.otherID = JSON.parse(this.$store.state.image_store.seller_info).publisherid\r\n      \r\n        console.log('mineId is '+this.mineID);\r\n        console.log('mineName is '+this.mineName);\r\n        console.log('otherId is '+this.otherID);\r\n        console.log('otherImgName is '+this.otherImgName)\r\n        this.initWebSocket();\r\n    },\r\n    destroyed() {\r\n      this.websock.close() \r\n    },\r\n    methods: {\r\n        getEXP: function (pageNow,pageSize) {\r\n            return this.EXPS.slice((pageNow - 1) * pageSize, pageSize * pageNow)\r\n        },\r\n        //发送消息\r\n        sendMsg: function(){\r\n\r\n            if(this.content==''){\r\n                Toast('请输入消息');\r\n                return;\r\n            }\r\n\r\n            var send=this.mineID+','+this.otherID+','+this.content\r\n            this.websocketsend(send);\r\n\r\n            this.records.push({\r\n                type: 1,\r\n                time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                name: this.mineName,\r\n                content: this.content\r\n            });\r\n\r\n            this.content='';\r\n            this.scrollToBottom();\r\n   \r\n        },\r\n      \r\n        focusTxtContent:function(){\r\n            document.querySelector(\"#txtContent input\").focus();\r\n        },\r\n    \r\n        scrollToBottom:function(){\r\n            setTimeout(function(){\r\n                var chatlist = document.getElementsByClassName('chatlist')[0];\r\n                chatlist.scrollTop=chatlist.scrollHeight;\r\n            },100);\r\n        },\r\n      \r\n        handleTopChange(status) {\r\n            this.topStatus = status;\r\n        },\r\n        loadTop(id) {\r\n            var _this=this;\r\n            setTimeout(() => {\r\n                var chatlist = document.getElementsByClassName('chatlist')[0];\r\n                var oldHeight=chatlist.scrollHeight;\r\n\r\n                _this.records.unshift({\r\n                    type: 1,\r\n                    time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                    name: '你',\r\n                    content: '你好！'\r\n                }, {\r\n                    type: 2,\r\n                    time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n                    name: '对方',\r\n                    content: '你好！'\r\n                });\r\n\r\n                setTimeout(function(){\r\n                    var newHeight=chatlist.scrollHeight;\r\n                    chatlist.scrollTop=newHeight-oldHeight;\r\n                },100);\r\n\r\n                this.$refs.loadmore.onTopLoaded(id);\r\n            }, 1500);\r\n        },\r\n      initWebSocket(){ //初始化weosocket\r\n        // const wsuri = \"ws://database.sustechstore.com:8888/websocket\";\r\n        const wsuri = \"ws://localhost:8888/websocket\";\r\n        this.websock = new WebSocket(wsuri);\r\n        this.websock.onmessage = this.websocketonmessage;\r\n        this.websock.onopen = this.websocketonopen;\r\n        this.websock.onerror = this.websocketonerror;\r\n        this.websock.onclose = this.websocketclose;\r\n      },\r\n      websocketonopen(){ //连接建立之后执行send方法发送数据\r\n        let actions = this.mineID;\r\n        // this.websocketsend(JSON.stringify(actions));\r\n        this.websocketsend(actions);\r\n      },\r\n      websocketonerror(){//连接建立失败重连\r\n        this.initWebSocket();\r\n      },\r\n      websocketonmessage(e){ //数据接收\r\n        console.log(e.data)\r\n        this.records.push({\r\n            type: 2,\r\n            time: util.formatDate.format(new Date(),'yyyy-MM-dd hh:mm:ss'),\r\n            name: this.otherName,\r\n            content: e.data\r\n        });\r\n        // const redata = JSON.parse(e.data);\r\n        // console.log('receive'+redata)\r\n      },\r\n      websocketsend(Data){//数据发送\r\n        this.websock.send(Data);\r\n        console.log('send'+Data)\r\n      },\r\n      websocketclose(e){  //关闭\r\n        console.log('断开连接',e);\r\n      },\r\n    },\r\n    async mounted() {\r\n        const that=this;\r\n        this.scrollToBottom();\r\n\r\n        let formdata = new FormData()\r\n        formdata.append('mineId', this.mineID)\r\n        formdata.append('otherId', this.otherID)\r\n\r\n        await axios({\r\n        url:\"/root\"+\"/chathistory\",\r\n        method:'post',\r\n        data:formdata\r\n        }).then(res => (this.records = res.data))\r\n\r\n        console.log('Chat history is'+this.records)\r\n        \r\n        await this.$axios.get('/root' + '/items/picture/' + that.otherImgName).then(function (res) {\r\n        if (res.status === 200) {\r\n            that.otherImg = res.data}\r\n        }).catch(function (error) {\r\n        console.log(error)\r\n        })\r\n\r\n    }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style>\r\n    .chatlist {\r\n        position: absolute;\r\n        top: 60px;\r\n        bottom: 48px;\r\n        left: 0px;\r\n        right: 0px;\r\n        overflow-y: scroll;\r\n        overflow-x: hidden;\r\n        padding: 10px;\r\n    }\r\n    \r\n    .chatlist-bottom {\r\n        bottom: 48px;\r\n    }\r\n    \r\n    .chatlist-bottom-collapse {\r\n        bottom: 198px;\r\n    }\r\n    \r\n    .chatlist ul {\r\n        min-height: 300px;\r\n    }\r\n    \r\n    .chatlist ul .chat-mine {\r\n        text-align: right;\r\n        padding-left: 0;\r\n        padding-right: 60px;\r\n    }\r\n\r\n    .chatlist ul .chat-other {\r\n        text-align: left;\r\n        padding-left: 30px;\r\n        padding-right: 0;\r\n    }\r\n    \r\n    .chatlist ul li {\r\n        position: relative;\r\n        /* font-size: 0; */\r\n        margin-bottom: 10px;\r\n        padding-left: 60px;\r\n        min-height: 68px;\r\n    }\r\n    \r\n    .chat-mine .chat-user {\r\n        left: auto;\r\n        right: 3px;\r\n    }\r\n\r\n    .chat-other .chat-user {\r\n        right: auto;\r\n        left: -25px;\r\n    }\r\n    \r\n    .chat-user {\r\n        position: absolute;\r\n        /* left: 3px; */\r\n    }\r\n    \r\n    /* .chat-text, */\r\n    .chat-user {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        /*font-size: 14px;*/\r\n    }\r\n    \r\n    .chat-user img {\r\n        width: 45px;\r\n        height: 45px;\r\n        border-radius: 100%;\r\n    }\r\n    \r\n    .time {\r\n        width: 100%;\r\n    }\r\n    \r\n    cite {\r\n        left: auto;\r\n        right: 60px;\r\n        text-align: right;\r\n    }\r\n    \r\n    cite {\r\n        font-style: normal;\r\n        line-height: 24px;\r\n        font-size: 20px;\r\n        white-space: nowrap;\r\n        color: #999;\r\n        text-align: left;\r\n    }\r\n    \r\n    cite i {\r\n        font-style: normal;\r\n        padding-left: 5px;\r\n        padding-right: 5px;\r\n        font-size: 12px;\r\n    }\r\n    \r\n    .chat-mine .chat-text {\r\n        margin-left: 0;\r\n        text-align: left;\r\n        background-color: #33DF83;\r\n        color: #fff;\r\n    }\r\n\r\n    .chat-other .chat-text {\r\n        margin-right: 0;\r\n        text-align: right;\r\n        background-color: #444647;\r\n        color: #fff;\r\n    }\r\n\r\n    .chat-text {\r\n        position: relative;\r\n        line-height: 22px;\r\n        margin-top: 10px;\r\n        padding: 10px 15px;\r\n        background-color: #eee;\r\n        border-radius: 3px;\r\n        color: #333;\r\n        word-break: break-all;\r\n        max-width: 462px\\9;\r\n    }\r\n    \r\n    .chat-text,\r\n    .chat-user {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        font-size: 14px;\r\n    }\r\n    \r\n    .chat-text img {\r\n        max-width: 100%;\r\n        vertical-align: middle;\r\n    }\r\n    \r\n    .chat-user {\r\n        position: absolute;\r\n        left: 3px;\r\n    }\r\n    \r\n    .chat-text:after {\r\n        content: '';\r\n        position: absolute;\r\n        left: -10px;\r\n        top: 15px;\r\n        width: 0;\r\n        height: 0;\r\n        border-style: solid dashed dashed;\r\n        border-color: #eee transparent transparent;\r\n        overflow: hidden;\r\n        border-width: 10px;\r\n    }\r\n    \r\n    .chat-mine .chat-text:after {\r\n        left: auto;\r\n        right: -10px;\r\n        border-top-color: #33DF83;\r\n    }\r\n    .chat-other .chat-text:after {\r\n        right: auto;\r\n        left: -10px;\r\n        border-top-color: #444647;\r\n    }\r\n    \r\n    .foot {\r\n        width: 100%;\r\n        min-height: 4px;\r\n        position: fixed;\r\n        bottom: 4px;\r\n        left: 0px;\r\n        background-color: #F8F8F8;\r\n    }\r\n    \r\n    .foot .con {\r\n        position: absolute;\r\n        left: 66px;\r\n        right: 40px;\r\n    }\r\n    \r\n    .foot .btn-plus {\r\n        width: 28px;\r\n        padding: 9px 3px;\r\n        position: absolute;\r\n        left: 0px;\r\n        border-left: 1px solid #d9d9d9;\r\n    }\r\n    \r\n    .foot .btn-plus i {\r\n        font-size: 2em;\r\n        color: #ccc;\r\n    }\r\n    \r\n    .foot .btn-face {\r\n        width: 28px;\r\n        padding: 9px 3px 9px 0px;\r\n        position: absolute;\r\n        left: 35px;\r\n        /*border-right: 1px solid #d9d9d9;*/\r\n    }\r\n    \r\n    .foot .btn-face i {\r\n        font-size: 2em;\r\n        color: #d9d9d9;\r\n    }\r\n    \r\n    .foot .selbox {\r\n        height: 150px;\r\n        margin-top: 48px;\r\n        border-top: 1px solid #d9d9d9;\r\n    }\r\n    \r\n    .show {\r\n        display: block;\r\n    }\r\n    \r\n    .hide {\r\n        display: none;\r\n    }\r\n    \r\n    .face-box {\r\n        position: absolute;\r\n        top: 48px;\r\n        left: 0px;\r\n        right: 0px;\r\n        bottom: 0px;\r\n        padding: 15px 15px 0px 15px;\r\n        overflow: hidden;\r\n        width: 290px;\r\n        margin: 0px auto;\r\n        height: 135px;\r\n    }\r\n    \r\n    .face-box li {\r\n        width: 30px;\r\n        float: left;\r\n        padding: 6px 10px 0px 8px;\r\n    }\r\n    \r\n    .btn {\r\n        display: inline-block;\r\n        vertical-align: top;\r\n        font-size: 14px;\r\n        line-height: 32px;\r\n        margin-left: 5px;\r\n        padding: 0 6px;\r\n        background-color: #33DF83;\r\n        color: #fff;\r\n        border-radius: 3px;\r\n    }\r\n    \r\n    .btn-send {\r\n        position: absolute;\r\n        right: 3px;\r\n        top: 6px;\r\n    }\r\n\r\n    /* .txtContent {\r\n       margin-right: 40px; \r\n    } */\r\n</style>"]}]}